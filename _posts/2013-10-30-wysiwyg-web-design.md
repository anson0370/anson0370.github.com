---
layout: post
title:  "WYSIWYG Web Design"
date:   2013-10-30 23:21:00
---

所见即所得的 web 页面制作，两种方式：使用 `position: absolute` 绝对定位；使用布局系统（例如 bootstrap 的 grid 网格系统）。

不论那种，可图形化配置的基础组件和拖拽都是必须的。

绝对定位的优缺点：

-   + 随便怎么放，自由度高
-   + 实现简单，容易上手
-   + 可通过互相重叠做到一些特殊效果
-   - 页面很难做的精致，像素级的对齐搞死人
-   - 响应式直接没法做
-   - 生成的 html 一坨屎
-   - 容器不能响应组件大小调整（动态增长的高度必须用 JS 来撑大容器）

布局系统的优缺点：

-   + 生成的 html 可读可维护
-   + 可做响应式布局
-   + 容器可响应组件大小调整
-   + 对齐毫无压力
-   - 自由度较低，结构相对固定（例如固定 12 格宽度的网格，就只能在 12 格里玩）
-   - 实现较复杂，使用有学习成本
-   - 组件之间无法简单重叠

因为绝对定位的缺点比较无法接受，所以一般来说都使用布局系统。

做 WYSIWYG 的主要就是两种：定制的装修系统（例如淘宝店铺装修什么的）；基于某些 framework 的快速原型开发（ divshot ，layoutit ）。

简单的竖向布局可以由 5 层结构组成：

1.  Container 最上层容器，宽度 100% ，可做通栏使用
2.  Grid 网格容器，定宽（例如 grid-12 1200px ）
3.  Row 行，可放在 Grid 或者 Col 中，宽度 100%
4.  Col 列，放置在 Row 中，定宽（例如 col-1 到 col-12 ，分别从 100px 到 1200px ）
5.  Widget 各种组件，特殊的业务组件以及文字、图片等通用组件，放置到 Col 中

要考虑的以及如何解决：

-   编辑模式和预览模式的切换

    通过根 class 的 toggle 即可搞定绝大部分。

-   编辑模式要显示的清晰而不凌乱

    为不同的结构显示不同的淡色 bg ，可以考虑使用 `rgba(black, 0.05)` 来叠加。

-   编辑时要易于选择和操作

    提供 hover 和 selected 状态，提供面包屑来选择父级结构， selected 时弹出工具栏，并显示只在编辑模式时才有的 padding 等。

-   拖放时的位置计算和提示算法

    分为同级结构的前后插入和添加到父级结构中两种情况，在 dragover 时使用明显而小的横竖线来提示 drop 后的目标位置。
    可以用 html5 标准的 drag & drop 或者 jQuery UI 的 drag & drop plugin。

-   可以锁住部分区域不能编辑，或者说指定一整个布局中的部分区域可编辑

    可在每一层结构上指定编辑状态的根 class ，带 editable root class 的结构不能拖动，不能删除，只能添加新结构。而此结构的内部结构则正常编辑。
    页面默认拥有 header, body, footer 三个 editable 区域。

各种 tips ：

-   编辑模式可以完全不考虑浏览器兼容性，所以只要把布局系统的基础 CSS 调教一下就可以随便宠幸现代浏览器了，如果是我就只支持 chrome ……

-   webkit 内核可以使用 css 来启用 html5 的 draggable ：使用 `-webkit-user-drag: element;`

-   编辑模式为结构添加虚线边框会导致你需要处理边框的额外高宽带来的各种问题，所以使用 `::before` 来生成一个提示结构是一个更好的选择

    例如一个高宽都是 `calc(100% - 1px)` 的带结构名字的浅色 bg 。

-   添加一些交互动画增强体验， `keyframes` 各种好使。例如来一个这样的元素添加时的动画：

    ```scss
    @-webkit-keyframes new-comp {
      0% {
        opacity: 0.4;
        @include transform(scale(1.2));
      }
      100% {
        opacity: 1;
        @include transform(scale(1));
      }
    }
    ```

暂时就这么多，想到再写
